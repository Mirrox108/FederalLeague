<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    <link rel="icon" href="images/logo.png">
    <meta name="description" content="Free, modern and nice web template for Minecraft server.">
    <meta name="author" content="Astronawta">

    <link rel="stylesheet" href="css/global.css">
    <link rel="stylesheet" href="css/pages/home.css">

    <title>FederalLeague | Главная</title>
    
    <style>
        /* Стили для экрана загрузки */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #1a1a1a 0%, #2c2c2e 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            transition: opacity 0.5s ease, visibility 0.5s ease;
        }

        .loading-screen.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .loading-content {
            text-align: center;
            max-width: 500px;
            width: 90%;
        }

        .loading-logo {
            margin-bottom: 15px;
            position: relative;
        }

        .loading-logo img {
            width: 120px;
            height: 120px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            background: transparent;
        }

        .loading-spinner {
            width: 30px;
            height: 30px;
            margin: 30px auto 0;
            border: 2px solid rgba(253, 187, 45, 0.2);
            border-top: 2px solid #fdbb2d;
            border-radius: 50%;
            animation: spin 1.5s linear infinite;
            background: transparent;
        }

        .loading-progress {
            margin-bottom: 30px;
        }

        .progress-bar {
            width: 100%;
            height: 6px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #fdbb2d, #f39c12);
            border-radius: 3px;
            width: 0%;
            transition: width 0.3s ease;
        }

        .loading-text {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .loading-percentage {
            color: #fdbb2d;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .loading-message {
            color: #ccc;
            font-size: 0.9rem;
        }

        .loading-tips {
            margin-top: 30px;
            padding: 15px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            border-left: 3px solid #fdbb2d;
        }

        .tip-item {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #ccc;
            font-size: 0.9rem;
        }

        .tip-item i {
            color: #fdbb2d;
        }

        /* Анимация появления контента после загрузки */
        .fade-in {
            animation: fadeIn 1s ease forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Стили для секций с начальной прозрачностью */
        #header,
        .online-players-section,
        #about,
        #news,
        #minigames,
        #discord,
        #faq {
            opacity: 0;
        }

        /* Стили для списка игроков онлайн */
        .online-players-section {
            padding: 60px 0;
            background: linear-gradient(135deg, #2c2c2e 0%, #444446ff 100%);
        }
        
        .online-players-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }
        
        .online-players-header {
            text-align: center;
            margin-bottom: 40px;
        }
        
        .online-players-header h2 {
            font-size: 2.5rem;
            color: #fff;
            margin-bottom: 15px;
        }
        
        .online-players-header p {
            color: #fdbb2d;
            font-size: 1.2rem;
        }
        
        .online-players-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .player-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(253, 187, 45, 0.3);
        }
        
        .player-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.15);
        }
        
        .player-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 0 auto 15px;
            border: 3px solid #fdbb2d;
            background: #2c2c2e;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
        }
        
        .player-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .player-avatar .avatar-placeholder {
            font-size: 2rem;
            color: #fdbb2d;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #3a3a3d;
        }
        
        .player-name {
            font-size: 1.2rem;
            color: #fff;
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .player-rank {
            display: inline-block;
            padding: 4px 12px;
            background: #fdbb2d;
            color: #333;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            margin-bottom: 10px;
        }
        
        .player-playtime {
            color: #ccc;
            font-size: 0.9rem;
        }
        
        .no-players {
            text-align: center;
            padding: 40px;
            grid-column: 1 / -1;
        }
        
        .no-players i {
            font-size: 3rem;
            color: #fdbb2d;
            margin-bottom: 20px;
        }
        
        .no-players p {
            color: #fff;
            font-size: 1.2rem;
        }
        
        .players-loading {
            text-align: center;
            padding: 40px;
            grid-column: 1 / -1;
        }
        
        .players-loading i {
            font-size: 2rem;
            color: #fdbb2d;
            margin-bottom: 15px;
            animation: spin 1s linear infinite;
        }
        
        .players-loading p {
            color: #fff;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .players-stats {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 30px;
            flex-wrap: wrap;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px 25px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
            border: 1px solid rgba(253, 187, 45, 0.3);
        }
        
        .stat-number {
            font-size: 2rem;
            color: #fdbb2d;
            font-weight: 700;
            display: block;
        }
        
        .stat-label {
            color: #fff;
            font-size: 0.9rem;
        }
        
        .error-message {
            text-align: center;
            padding: 40px;
            grid-column: 1 / -1;
            color: #ff6b6b;
        }
        
        .error-message i {
            font-size: 3rem;
            margin-bottom: 20px;
        }
        
        /* Стили для новостей */
        .news-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }
        
        .news-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 1px solid rgba(253, 187, 45, 0.2);
        }
        
        .news-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
            background: rgba(255, 255, 255, 0.08);
        }
        
        .news-image {
            position: relative;
            width: 100%;
            height: 200px;
            overflow: hidden;
        }
        
        .news-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }
        
        .news-item:hover .news-image img {
            transform: scale(1.05);
        }
        
        /* Стили для даты поверх изображения */
        .news-date-overlay {
            position: absolute;
            top: 15px;
            left: 15px;
            background: linear-gradient(135deg, #fdbb2d 0%, #f39c12 100%);
            color: #333;
            padding: 12px;
            border-radius: 8px;
            text-align: center;
            min-width: 50px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
            z-index: 2;
        }
        
        .news-day {
            font-size: 1.8rem;
            font-weight: bold;
            line-height: 1;
            display: block;
        }
        
        .news-month {
            font-size: 0.9rem;
            text-transform: uppercase;
            font-weight: 600;
            display: block;
        }
        
        .news-content {
            padding: 20px;
        }
        
        .news-title {
            font-size: 1.4rem;
            color: #fff;
            margin-bottom: 12px;
            line-height: 1.3;
        }
        
        .news-excerpt {
            color: #ccc;
            margin-bottom: 20px;
            line-height: 1.5;
        }
        
        .news-read-btn {
            background: linear-gradient(135deg, #fdbb2d 0%, #f39c12 100%);
            color: #333;
            border: none;
            padding: 10px 20px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }
        
        .news-read-btn:hover {
            background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.3);
        }
        
        .news-full-content {
            display: none;
        }
        
        .news-actions {
            text-align: center;
            margin-top: 40px;
        }
        
        .view-all-news {
            display: inline-block;
            padding: 12px 30px;
            background: transparent;
            color: #fdbb2d;
            border: 2px solid #fdbb2d;
            border-radius: 6px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .view-all-news:hover {
            background: #fdbb2d;
            color: #333;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(253, 187, 45, 0.3);
        }
        
        /* Стили для загрузки и сообщений */
        .news-loading {
            text-align: center;
            padding: 60px 20px;
            grid-column: 1 / -1;
        }
        
        .news-loading i {
            font-size: 2.5rem;
            color: #fdbb2d;
            margin-bottom: 20px;
            animation: spin 1s linear infinite;
        }
        
        .news-loading p {
            color: #fff;
            font-size: 1.1rem;
        }
        
        .no-news {
            text-align: center;
            padding: 60px 20px;
            grid-column: 1 / -1;
        }
        
        /* Модальное окно */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            overflow: auto;
        }
        
        .modal-content {
            background: linear-gradient(135deg, #2c2c2e 0%, #444446 100%);
            margin: 5% auto;
            padding: 0;
            border-radius: 12px;
            width: 90%;
            max-width: 800px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(253, 187, 45, 0.3);
            position: relative;
            animation: modalFadeIn 0.3s ease;
        }
        
        @keyframes modalFadeIn {
            from { opacity: 0; transform: translateY(-50px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 20px;
            color: #fff;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            z-index: 10;
            transition: color 0.3s ease;
        }
        
        .modal-close:hover {
            color: #fdbb2d;
        }
        
        .modal-header {
            padding: 25px;
            background: rgba(0, 0, 0, 0.2);
            border-bottom: 1px solid rgba(253, 187, 45, 0.2);
            display: flex;
            align-items: center;
            gap: 20px;
        }
        
        .modal-date {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-width: 60px;
            background: #fdbb2d;
            color: #333;
            padding: 10px;
            border-radius: 8px;
        }
        
        .modal-day {
            font-size: 1.8rem;
            font-weight: bold;
            line-height: 1;
        }
        
        .modal-month {
            font-size: 0.9rem;
            text-transform: uppercase;
            font-weight: 600;
        }
        
        .modal-title {
            color: #fff;
            font-size: 1.6rem;
            margin: 0;
            flex: 1;
        }
        
        .modal-body {
            padding: 25px;
        }
        
        .modal-image {
            margin-bottom: 20px;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .modal-image img {
            width: 100%;
            max-height: 350px;
            object-fit: cover;
        }
        
        .modal-text {
            color: #eee;
            line-height: 1.6;
            font-size: 1.05rem;
        }
        
        .modal-text p {
            margin-bottom: 15px;
        }
        
        .modal-footer {
            padding: 20px 25px;
            background: rgba(0, 0, 0, 0.2);
            border-top: 1px solid rgba(253, 187, 45, 0.2);
            text-align: right;
        }
        
        .modal-close-btn {
            background: #fdbb2d;
            color: #333;
            border: none;
            padding: 10px 25px;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .modal-close-btn:hover {
            background: #f39c12;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(243, 156, 18, 0.3);
        }
        
        @media (max-width: 768px) {
            .online-players-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .player-card {
                padding: 15px;
            }
            
            .player-avatar {
                width: 60px;
                height: 60px;
            }
            
            .players-stats {
                flex-direction: column;
                gap: 15px;
            }
            
            .news-container {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 10% auto;
            }
            
            .modal-header {
                flex-direction: column;
                text-align: center;
                gap: 15px;
            }
            
            .loading-logo img {
                width: 100px;
                height: 100px;
            }
            
            .loading-text {
                flex-direction: column;
                gap: 5px;
            }
            
            .tip-item {
                font-size: 0.8rem;
            }
            
            /* Адаптивность для даты на новостях */
            .news-date-overlay {
                top: 10px;
                left: 10px;
                padding: 8px;
                min-width: 40px;
            }
            
            .news-day {
                font-size: 1.5rem;
            }
            
            .news-month {
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <!-- Экран загрузки -->
    <div id="loading-screen" class="loading-screen">
        <div class="loading-content">
            <div class="loading-logo">
                <img src="images/logo.png" alt="Federal League Logo">
                <div class="loading-spinner"></div>
            </div>
            <div class="loading-progress">
                <div class="progress-bar">
                    <div class="progress-fill"></div>
                </div>
                <div class="loading-text">
                    <span class="loading-percentage">0%</span>
                    <span class="loading-message">Загрузка ресурсов...</span>
                </div>
            </div>
            <div class="loading-tips">
                <div class="tip-item">
                    <i class="fas fa-lightbulb"></i>
                    <span>Совет: Используйте /town create для создания своего города</span>
                </div>
            </div>
        </div>
    </div>

    <!--Navbar-->
    <div class="navbar">
        <div class="menu-mobile">
            <a href="index.html">
                <div class="logo">
                    <img src="images/logo.png" alt="Server logo" class="logo-img">
                    <h3 class="server-name">Federal League</h3>
                </div>
            </a>

            <div class="hamburger">
                <i class="fa-solid fa-bars"></i>
            </div>
        </div>

        <div class="links">
            <a href="#" class="link active">Главная</a>
            <a href="rules.html" class="link">Правила</a>
            <a href="admin-team.html" class="link">Команда</a>
            <a href="contact.html" class="link">Связь</a>
            <a href="account.html" class="link">Личный кабинет</a>
        </div>
    </div>

    <!--Header-->
    <section id="header">
        <div class="content">

            <div class="left">
                <div class="server-name">
                    <p>ПОЛИТИЧЕСКИЙ MINECRAFT СЕРВЕР</p>
                    <h1 class="minecraft-server-ip">mc.federalleague.ru</h1>
                </div>
                <p class="server-description">
                    Создайте своё государство, пишите законы, стройте города и определяйте их судьбу. Ваше решение изменит ход истории сервера.
                    <br><br>Присоединяйся и играй со своими друзьями!
                </p>
                <div class="buttons">
                    <button class="copy-ip">Скопировать IP</button>
                    <a href="#about"><button class="how-to-join">Узнать болльше</button></a>
                </div>
                <p class="ip-copied">IP успешно скопирован!</p>
            </div>

            <div class="right">
                <img src="images/logo.png" alt="Server logo" class="logo-img logo-img-header">

                <div class="stats">
                    <div class="stat">
                        <div class="icon">
                            <i class="fa-brands fa-discord"></i>
                        </div>
                        <div class="texts">
                            <h5 class="stat-title">Discord server</h5>
                            <p><span class="stat-number discord-online-users">None</span> users online</p>
                        </div>
                    </div>
                    <div class="stat">
                        <div class="icon">
                            <i class="fa-solid fa-server"></i>
                        </div>
                        <div class="texts">
                            <h5 class="stat-title">Minecraft server</h5>
                            <p><span class="stat-number minecraft-online-players">None</span> players online</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!--About us-->
    <section id="about">
        <div class="content">
            <div class="left">
                <h2 class="section-title">Кто мы?</h2>
                <p class="about-us">Добро пожаловать в Federal League! Здесь великие империи не рождаются — их создают. На этом сервере нет места случайным игрокам. Здесь правят стратеги, заговорщики и полководцы. Каждый чанк — ваша земля. Каждый закон — ваша воля. Каждая война — ваша история. Создайте державу, которая переживет века, или станьте тем, кто стянет их в прах. Основать город — это только начало. Ваша истинная цель — завоевать весь мир. Готовы ли вы к власти? </p>
            </div>

            <div class="right">
                <img src="images/about-section-person-image.png" alt="Minecraft person">
                <div class="img-background"></div>
            </div>
        </div>
    </section>

    <!--News-->
    <section id="news">
        <div class="content">
            <h2 class="section-title">Последние <span>новости</span></h2>
            <p class="section-description">Следите за обновлениями и событиями на нашем сервере</p>
            
            <div class="news-container" id="news-container">
                <div class="news-loading">
                    <i class="fas fa-spinner fa-spin"></i>
                    <p>Загрузка новостей...</p>
                </div>
            </div>
            
            <div class="news-actions">
                <a href="#news" class="view-all-news" onclick="loadAllNews()">Смотреть все новости</a>
            </div>
        </div>
    </section>

    <!--Mini games-->
    <section id="minigames">
        <div class="content miniGames-list">
            <div class="game">
                <img src="images/survival-minigames-image.jpg" alt="Survival image">

                <div class="info">
                    <h2 class="section-title">Система войн</h2>
                    <div class="game-description">
                        <p>Участвуйте в эпических сражениях между государствами. Захватывайте территории, формируйте альянсы и доминируйте на политической карте сервера.</p>
                        <ul class="services">
                            <li class="service">Система осад</li>
                            <li class="service">Военные союзы</li>
                            <li class="service">Захват территорий</li>
                            <li class="service">Дипломатия</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="game">
                <img src="images/survival-minigames-image.jpg" alt="Survival image">

                <div class="info">
                    <h2 class="section-title">Политическая система</h2>
                    <div class="game-description">
                        <p>Создавайте законы, формируйте правительство, участвуйте в выборах и управляйте своим государством с помощью сложной политической системы.</p>
                        <ul class="services">
                            <li class="service">Законодательство</li>
                            <li class="service">Выборы</li>
                            <li class="service">Налоговая система</li>
                            <li class="service">Государственные должности</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!--Discord-->
    <section id="discord">
        <div class="content">
            <h2 class="section-title">Появились <span>проблемы?</span> Поддержка всегда рядом <br> Присоединяйся к нам в <span>Discord!</span></h2>
            <a href="#" class="discord-link"><button class="join-discord">Присоединится в Discord</button></a>
        </div>
    </section>

    <!--FAQs-->
    <section id="faq">
        <div class="content">
            <div class="info">
                <h2 class="section-title">Частые <span>Вопросы.</span></h2>
                <p class="section-description">Здесь мы ответили на самые часто задаваемые вопросы!</p>
            </div>

            <div class="accordion faqList">
                <div class="accordion-item">
                    <div class="accordion-item-header">
                        Проходка платная?
                    </div>
                    <div class="accordion-item-body">
                        <div class="accordion-item-body-content">
                            Нет. Проходка как и весь наш сервер абсолютно бесплатны. На сервере присутствует своя экономика
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-item-header">
                        Нужна лицензия?
                    </div>
                    <div class="accordion-item-body">
                        <div class="accordion-item-body-content">
                            Нет. Вы можете присоединится к серверу как с лицензии так и пиратки
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-item-header">
                        Могу ли я играть здесь со своими друзьями?
                    </div>
                    <div class="accordion-item-body">
                        <div class="accordion-item-body-content">
                            Да конечно! Вы можете привести своих друзей на сервер и получить за них бонусы. Также здесь вы можете найти и новых друзей
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-item-header">
                        Как создать город или нацию?
                    </div>
                    <div class="accordion-item-body">
                        <div class="accordion-item-body-content">
                            Для создания города используйте команду /town create [название]. Для создания государства необходимо объединить несколько городов с помощью команды /nation create [название].
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-item-header">
                        Что делать если я потерял вещи?
                    </div>
                    <div class="accordion-item-body">
                        <div class="accordion-item-body-content">
                            Мы не восстанавливаем потерянные вещи, если это не связано с багом сервера. Рекомендуем использовать эндерсундуки для хранения ценных предметов и быть осторожным в опасных зонах.
                        </div>
                    </div>
                </div>

                <div class="accordion-item">
                    <div class="accordion-item-header">
                        Как сообщить о нарушителе?
                    </div>
                    <div class="accordion-item-body">
                        <div class="accordion-item-body-content">
                            Если вы столкнулись с нарушителем правил, сделайте скриншот или запишите видео нарушения, а затем обратитесь к модератору в Discord или через форму обращения. Укажите никнейм нарушителя, время нарушения и приложите доказательства.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!--Footer-->
    <footer id="footer">
        <p class="copyright">&copy; 2025 <span class="server-name-footer">Federal League</span>. Все права завоёванны.</p>
        <div class="social-links">
            <a href="#" class="link tiktok-link"><i class="fa-brands fa-tiktok"></i></a>
            <a href="#" class="link instagram-link"><i class="fa-brands fa-telegram"></i></a>
            <a href="#" class="link discord-link-footer"><i class="fa-brands fa-discord"></i></a>
        </div>
    </footer>

    <!-- Модальное окно для новостей -->
    <div id="news-modal" class="modal">
        <div class="modal-content">
            <span class="modal-close">&times;</span>
            <div class="modal-header">
                <div class="modal-date">
                    <span class="modal-day">15</span>
                    <span class="modal-month">Янв</span>
                </div>
                <h2 class="modal-title">Заголовок новости</h2>
            </div>
            <div class="modal-body">
                <div class="modal-image">
                    <img src="" alt="">
                </div>
                <div class="modal-text"></div>
            </div>
            <div class="modal-footer">
                <button class="modal-close-btn">Закрыть</button>
            </div>
        </div>
    </div>
</body>
<script src="js/script.js"></script>
<script src="js/modals.js"></script>
<script src="https://kit.fontawesome.com/cbf5ee59c8.js" crossorigin="anonymous"></script>

<script>
// Конфигурация API
const API_CONFIG = {
    BASE_URL: 'https://api.federalleague.ru',
    ENDPOINTS: {
        PLAYERS: '/players/online',
        SERVER_STATUS: '/server/status',
        STATS: '/server/stats'
    }
};

// Функция для отображения экрана загрузки
function initLoadingScreen() {
    const loadingScreen = document.getElementById('loading-screen');
    const progressFill = document.querySelector('.progress-fill');
    const loadingPercentage = document.querySelector('.loading-percentage');
    const loadingMessage = document.querySelector('.loading-message');
    
    if (!loadingScreen) return;
    
    // Имитация прогресса загрузки
    const totalSteps = 10;
    let currentStep = 0;
    
    const loadingMessages = [
        "Загрузка ресурсов...",
        "Инициализация сервера...",
        "Загрузка текстур...",
        "Подготовка карты...",
        "Оптимизация производительности...",
        "Загрузка игровых данных...",
        "Проверка обновлений...",
        "Подключение к базе данных...",
        "Инициализация плагинов...",
        "Завершение загрузки..."
    ];
    
    const simulateProgress = () => {
        if (currentStep <= totalSteps) {
            const progress = (currentStep / totalSteps) * 100;
            progressFill.style.width = `${progress}%`;
            loadingPercentage.textContent = `${Math.round(progress)}%`;
            
            if (currentStep < loadingMessages.length) {
                loadingMessage.textContent = loadingMessages[currentStep];
            }
            
            currentStep++;
            setTimeout(simulateProgress, 300 + Math.random() * 300);
        } else {
            // Загрузка завершена
            setTimeout(() => {
                loadingScreen.classList.add('hidden');
                
                // Добавляем анимацию появления контента
                document.querySelectorAll('section').forEach((section, index) => {
                    setTimeout(() => {
                        section.classList.add('fade-in');
                    }, index * 100);
                });
            }, 500);
        }
    };
    
    // Запускаем симуляцию загрузки
    setTimeout(simulateProgress, 1000);
    
    // Альтернативный вариант: реальная загрузка ресурсов
    window.addEventListener('load', () => {
        // Если реальная загрузка завершилась раньше, чем симуляция
        setTimeout(() => {
            progressFill.style.width = '100%';
            loadingPercentage.textContent = '100%';
            loadingMessage.textContent = 'Загрузка завершена!';
            
            setTimeout(() => {
                loadingScreen.classList.add('hidden');
                
                // Добавляем анимацию появления контента
                document.querySelectorAll('section').forEach((section, index) => {
                    setTimeout(() => {
                        section.classList.add('fade-in');
                    }, index * 100);
                });
            }, 500);
        }, 500);
    });
}

// Функция для загрузки списка игроков онлайн через API
async function loadOnlinePlayers() {
    const playersGrid = document.getElementById('online-players-grid');
    
    // Показываем индикатор загрузки
    playersGrid.innerHTML = `
        <div class="players-loading">
            <i class="fas fa-spinner"></i>
            <p>Загрузка списка игроков...</p>
        </div>
    `;
    
    try {
        // Запрос к API для получения данных об игрокаи
        const response = await fetch(`${API_CONFIG.BASE_URL}${API_CONFIG.ENDPOINTS.PLAYERS}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json',
            // Раскомментируйте если API требует аутентификацию
                // 'Authorization': 'Bearer YOUR_API_TOKEN'
            }
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        // Обновляем статистику
        document.getElementById('total-players').textContent = data.totalPlayers || '0';
        document.getElementById('online-now').textContent = data.onlineCount || '0';
        document.getElementById('max-online').textContent = data.maxOnline || '0';
        
        // Очищаем контейнер
        playersGrid.innerHTML = '';
        
        // Добавляем карточки игроков
        if (data.players && data.players.length > 0) {
            data.players.forEach(player => {
                const playerCard = document.createElement('div');
                playerCard.className = 'player-card';
                playerCard.innerHTML = `
                    <div class="player-avatar">
                        ${player.avatar ? 
                            `<img src="${player.avatar}" alt="${player.name}" onerror="this.style.display='none'; this.parentNode.innerHTML='<div class=\"avatar-placeholder\"><i class=\"fas fa-user\"></i></div>'">` : 
                            `<div class="avatar-placeholder"><i class="fas fa-user"></i></div>`
                        }
                    </div>
                    <h3 class="player-name">${player.name}</h3>
                    <span class="player-rank">${player.rank || 'Игрок'}</span>
                    <p class="player-playtime">${player.playtime || 'Неизвестно'}</p>
                `;
                playersGrid.appendChild(playerCard);
            });
        } else {
            playersGrid.innerHTML = `
                <div class="no-players">
                    <i class="fas fa-users-slash"></i>
                    <p>Сейчас на сервере нет игроков</p>
                    <p>Будьте первым, кто присоединится!</p>
                </div>
            `;
        }
    } catch (error) {
        console.error('Ошибка при загрузке списка игроков:', error);
        playersGrid.innerHTML = `
            <div class="error-message">
                <i class="fas fa-exclamation-triangle"></i>
                <p>Ошибка загрузки данных</p>
                <p>Попробуйте обновить страницу позже</p>
            </div>
        `;
    }
}

// Функция для загрузки новостей из JSON файла
async function loadNews() {
    const newsContainer = document.getElementById('news-container');
    if (!newsContainer) return;
    
    // Показываем индикатор загрузки
    newsContainer.innerHTML = `
        <div class="news-loading">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Загрузка новостей...</p>
        </div>
    `;

    try {
        // Пытаемся загрузить новости из JSON файла
        console.log('Попытка загрузки новостей из news.json...');
        const response = await fetch('news.json', {
            headers: {
                'Content-Type': 'application/json',
                'Accept': 'application/json'
            },
            cache: 'no-cache'
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        console.log('Новости успешно загружены из файла:', data);
        
        // Очищаем контейнер
        newsContainer.innerHTML = '';
        
        // Добавляем новости
        if (data.news && data.news.length > 0) {
            const publishedNews = data.news.filter(news => news.status === 'published');
            
            if (publishedNews.length > 0) {
                // Сортируем новости по дате (новые сначала)
                publishedNews.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                // Показываем только последние 3 новости на главной
                publishedNews.slice(0, 3).forEach(item => {
                    addNewsItem(newsContainer, item);
                });
                
                // Сохраняем все новости в localStorage для быстрого доступа
                localStorage.setItem('fl_news', JSON.stringify(publishedNews));
                console.log('Новости сохранены в localStorage');
            } else {
                console.log('Нет опубликованных новостей');
                showNoNewsMessage(newsContainer);
            }
        } else {
            console.log('Нет новостей в файле');
            showNoNewsMessage(newsContainer);
        }
    } catch (error) {
        console.error('Ошибка при загрузке новостей из файла:', error);
        
        // Пытаемся загрузить новости из localStorage
        try {
            const localNews = JSON.parse(localStorage.getItem('fl_news') || '[]');
            console.log('Попытка загрузки из localStorage:', localNews);
            
            if (localNews.length > 0) {
                newsContainer.innerHTML = '';
                localNews.slice(0, 3).forEach(item => {
                    addNewsItem(newsContainer, item);
                });
                console.log('Новости загружены из localStorage');
            } else {
                // Если в localStorage тоже нет новостей, показываем демо-новости
                console.log('Загрузка демо-новостей');
                showDemoNews(newsContainer);
            }
        } catch (localError) {
            console.error('Ошибка при загрузке из localStorage:', localError);
            showDemoNews(newsContainer);
        }
    }
}

// Функция для показа демо-новостей
function showDemoNews(container) {
    console.log('Показ демо-новостей');
    const demoNews = [
        {
            id: 1,
            title: "Запуск нового сезона!",
            date: new Date().toISOString(),
            image: "images/news1.jpg",
            excerpt: "Мы рады объявить о начале нового сезона на нашем сервере. Много новых возможностей и улучшений ждут вас!",
            content: `<p>Мы рады объявить о начале нового сезона на нашем сервере Federal League! Этот сезон принесет много новых возможностей и улучшений:</p>
                     <ul>
                         <li>Обновленная политическая система</li>
                         <li>Новые механики войны между государствами</li>
                         <li>Улучшенная экономическая система</li>
                         <li>Исправление множества багов и оптимизация производительности</li>
                     </ul>
                     <p>Присоединяйтесь к нам и станьте частью истории нашего сервера!</p>`,
            status: "published"
        },
        {
            id: 2,
            title: "Конкурс на лучший город",
            date: new Date(Date.now() - 5 * 24 * 60 * 60 * 1000).toISOString(),
            image: "images/news2.jpg",
            excerpt: "Объявляем конкурс на самый красивый и функциональный город. Ценные призы победителям!",
            content: `<p>Объявляем конкурс на самый красивый и функциональный город на нашем сервере! Условия участия:</p>
                     <ul>
                         <li>Город должен быть основан не позднее чем за неделю до окончания конкурса</li>
                         <li>Минимальное количество жителей - 5 человек</li>
                         <li>Город должен иметь уникальный дизайн и инфраструктуру</li>
                     </ul>
                     <p>Главный приз: 5000 FL Coins и уникальный титул «Архитектор сезона»!</p>`,
            status: "published"
        },
        {
            id: 3,
            title: "Обновление системы сражений",
            date: new Date(Date.now() - 10 * 24 * 60 * 60 * 1000).toISOString(),
            image: "images/news3.jpg",
            excerpt: "Мы полностью переработали систему войн и сражений между государствами. Теперь битвы стали еще эпичнее!",
            content: `<p>Мы полностью переработали систему войн и сражений между государствами. Основные изменения:</p>
                     <ul>
                         <li>Новая система осад замков и крепостей</li>
                         <li>Улучшенный баланс между нападающими и защитниками</li>
                         <li>Добавлены новые виды осадных орудий</li>
                         <li>Введена система военных рангов и званий</li>
                     </ul>
                     <p>Теперь битвы стали еще эпичнее и стратегически интереснее!</p>`,
            status: "published"
        }
    ];
    
    container.innerHTML = '';
    
    demoNews.forEach(item => {
        addNewsItem(container, item);
    });
    
    // Сохраняем демо-новости в localStorage
    localStorage.setItem('fl_news', JSON.stringify(demoNews));
}

// Функция для показа сообщения об отсутствии новостей
function showNoNewsMessage(container) {
    container.innerHTML = `
        <div class="no-news">
            <i class="fas fa-newspaper" style="font-size: 3rem; color: #fdbb2d; margin-bottom: 20px;"></i>
            <p style="color: #fff; font-size: 1.2rem;">Новостей пока нет</p>
            <p style="color: #ccc;">Следите за обновлениями!</p>
        </div>
    `;
}

// Функция для добавления элемента новости
function addNewsItem(container, item) {
    const newsItem = document.createElement('div');
    newsItem.className = 'news-item';
    
    const newsDate = new Date(item.date);
    const day = newsDate.getDate();
    const month = newsDate.toLocaleString('ru-RU', { month: 'short' });
    
    newsItem.innerHTML = `
        <div class="news-image">
            <img src="${item.image || 'images/news-placeholder.jpg'}" alt="${item.title || 'Новость'}" onerror="this.src='images/news-placeholder.jpg'">
            <div class="news-date-overlay">
                <span class="news-day">${day}</span>
                <span class="news-month">${month}</span>
            </div>
        </div>
        <div class="news-content">
            <h3 class="news-title">${item.title || 'Без названия'}</h3>
            <p class="news-excerpt">${item.excerpt || 'Описание отсутствует'}</p>
            <button class="news-read-btn" onclick="openNewsModal(this.parentNode.parentNode)">
                <i class="fas fa-book-open"></i>
                Читать далее
            </button>
            <div class="news-full-content" style="display: none;">
                ${item.content || '<p>Содержимое новости недоступно</p>'}
            </div>
        </div>
    `;
    
    container.appendChild(newsItem);
}

// Функция для загрузки всех новостей
async function loadAllNews() {
    try {
        const newsContainer = document.getElementById('news-container');
        if (!newsContainer) return;
        
        // Показываем индикатор загрузки
        newsContainer.innerHTML = `
            <div class="news-loading">
                <i class="fas fa-spinner fa-spin"></i>
                <p>Загрузка всех новостей...</p>
            </div>
        `;
        
        let newsData = [];
        
        // Пытаемся загрузить из файла
        try {
            const response = await fetch('news.json');
            if (response.ok) {
                const data = await response.json();
                newsData = data.news || [];
            } else {
                throw new Error('File not found');
            }
        } catch (error) {
            // Если файл не доступен, загружаем из localStorage
            console.log('Загрузка из localStorage...');
            const localNews = JSON.parse(localStorage.getItem('fl_news') || '[]');
            newsData = localNews;
        }
        
        // Очищаем контейнер
        newsContainer.innerHTML = '';
        
        // Добавляем все новости
        if (newsData.length > 0) {
            const publishedNews = newsData.filter(news => !news.status || news.status === 'published');
            
            if (publishedNews.length > 0) {
                // Сортируем новости по дате (новые сначала)
                publishedNews.sort((a, b) => new Date(b.date) - new Date(a.date));
                
                publishedNews.forEach(item => {
                    addNewsItem(newsContainer, item);
                });
            } else {
                showNoNewsMessage(newsContainer);
            }
        } else {
            // Если новостей нет, показываем демо-новости
            showDemoNews(newsContainer);
        }
        
        // Скрываем кнопку "Смотреть все новости"
        const viewAllButton = document.querySelector('.view-all-news');
        if (viewAllButton) {
            viewAllButton.style.display = 'none';
        }
        
    } catch (error) {
        console.error('Ошибка при загрузке всех новостей:', error);
        // Показываем демо-новости при ошибке
        showDemoNews(document.getElementById('news-container'));
    }
}

// Функция для открытия модального окна с новостью
function openNewsModal(newsItem) {
    const modal = document.getElementById('news-modal');
    const modalTitle = modal.querySelector('.modal-title');
    const modalImage = modal.querySelector('.modal-image img');
    const modalText = modal.querySelector('.modal-text');
    const modalDate = modal.querySelector('.modal-date');
    
    // Получаем данные из новости
    const title = newsItem.querySelector('.news-title').textContent;
    const image = newsItem.querySelector('.news-image img').src;
    const content = newsItem.querySelector('.news-full-content').innerHTML;
    
    // Получаем дату из overlay
    const dateOverlay = newsItem.querySelector('.news-date-overlay');
    const day = dateOverlay.querySelector('.news-day').textContent;
    const month = dateOverlay.querySelector('.news-month').textContent;
    
    // Заполняем модальное окно
    modalTitle.textContent = title;
    modalImage.src = image;
    modalText.innerHTML = content;
    modalDate.querySelector('.modal-day').textContent = day;
    modalDate.querySelector('.modal-month').textContent = month;
    
    // Показываем модальное окно
    modal.style.display = 'block';
}

// Функция для обновления счетчиков в хедере
async function updateServerCounters() {
    try {
        const response = await fetch(`${API_CONFIG.BASE_URL}${API_CONFIG.ENDPOINTS.SERVER_STATUS}`);
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        if (data.online) {
            const minecraftOnlineElement = document.querySelector('.minecraft-online-players');
            const discordOnlineElement = document.querySelector('.discord-online-users');
            
            if (minecraftOnlineElement) {
                minecraftOnlineElement.textContent = data.players.online || '0';
            }
            
            // Если API также возвращает данные Discord
            if (data.discord && discordOnlineElement) {
                discordOnlineElement.textContent = data.discord.members || '0';
            }
        }
    } catch (error) {
        console.error('Ошибка при обновлении счетчиков:', error);
    }
}

// Функция для получения статистики сервера
async function loadServerStats() {
    try {
        const response = await fetch(`${API_CONFIG.BASE_URL}${API_CONFIG.ENDPOINTS.STATS}`);
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const data = await response.json();
        
        // Обновляем статистику в секции игроков
        if (data.totalPlayers) {
            document.getElementById('total-players').textContent = data.totalPlayers;
        }
        if (data.maxOnline) {
            document.getElementById('max-online').textContent = data.maxOnline;
        }
    } catch (error) {
        console.error('Ошибка при загрузке статистики сервера:', error);
    }
}

// Закрытие модального окна
document.addEventListener('DOMContentLoaded', function() {
    const modal = document.getElementById('news-modal');
    const closeBtn = modal.querySelector('.modal-close');
    const closeBtn2 = modal.querySelector('.modal-close-btn');
    
    closeBtn.addEventListener('click', function() {
        modal.style.display = 'none';
    });
    
    closeBtn2.addEventListener('click', function() {
        modal.style.display = 'none';
    });
    
    window.addEventListener('click', function(event) {
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    });
});

// Загружаем данные при загрузке страницы
document.addEventListener('DOMContentLoaded', function() {
    initLoadingScreen();
    
    // Загружаем контент после небольшой задержки для демонстрации экрана загрузки
    setTimeout(() => {
        loadOnlinePlayers();
        loadNews();
        updateServerCounters();
        loadServerStats();
    }, 1500);
    
    // Обновляем список каждые 2 минуты
    setInterval(loadOnlinePlayers, 120000);
    
    // Обновляем счетчики каждую минуту
    setInterval(updateServerCounters, 60000);
});

// Функция для обработки ошибок изображений (резервная)
function handleImageError(img) {
    img.style.display = 'none';
    img.parentNode.innerHTML = '<div class="avatar-placeholder"><i class="fas fa-user"></i></div>';
}
</script>
</html>